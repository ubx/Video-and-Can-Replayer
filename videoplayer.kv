#:import win kivy.core.window

<MapWidget@Scatter>:
#    #  for debugging:
#    canvas.before:
#        Color:
#            rgba: 1, 1, 1, 1
#        Rectangle:
#            pos: self.pos
#            size: self.size

<SymbolWidget@Scatter>:


<MainWindow>:
    BoxLayout:
        orientation: 'vertical'
        AnchorLayout:
            VideoPlayer:
                id: video_player
                source: app.get_file()
                allow_stretch: True
                state: 'stop'
                on_state:
                    app.on_state(args[1])
                on_position:
                    app.on_position(args[1], video_player)
                    slider.value=args[1]

            MapWidget:
                AnchorLayout:
                    id: map
                    size_hint: 300,300
                    SymbolWidget:
                        id: symbol
                        center: map.center


        BoxLayout:
            orientation: 'horizontal'
            size_hint_y: None
            height: '48dp'

            Button:
                text: 'Next'
                on_press:
                    app.btn_next(video_player)

            Button:
                text: 'Previous'
                on_press:
                    app.btn_previous(video_player)

            Button:
                text: 'Bookmark'
                on_press:
                    app.btn_bookmark(video_player)

            Button:
                text: 'Syncpoint'
                on_press:
                    app.btn_syncpoint(video_player)


        BoxLayout:
            orientation: 'vertical'
            size_hint_y: None
            height: '48dp'

            Label:
                text:
                    app.realtime(slider.value)

            Slider:
                id: slider
                min: 0
                max: video_player.duration
                step: 1
                disabled: True
                on_width:
                    app.on_width()


        BoxLayout:
            id: bookmarks
            orientation: 'vertical'
            size_hint: None, None
            height: '92'

#        BoxLayout:
#            orientation: 'horizontal'
#            size_hint_y: None
#            size_hint_x: 0.3
#            height: '24'
#
#            Label:
#                text: 'UTC'
#            Label:
#                text: '12:33'
#            Label:
#                text: 'Pos'
#            Label:
#                text: '7.0 / 47.0'


<ModalDialog>:
    size_hint: None, None
    size: 400, 180

    BoxLayout:
        orientation: 'vertical'
        Label:
            text: "Enter utc time"
        Label:
            id: label
        TextInput:
            multiline: False
            hint_text:'Enter time'
            on_text:
                root.ts=root.checkTime(args[1])
                label.text= 'YYYY-MM-DD HH:MM:SS' if root.ts is None else args[1]
                btn_bookmark.disabled=root.ts is None

        BoxLayout:
            orientation: 'horizontal'
            Button:
                id: btn_bookmark
                text: "OK"
                disabled: True
                on_release:
                    root.set_syncpoint()
                    root.dismiss()
            Button:
                text: "Cancel"
                on_release:
                    root.dismiss()
